<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#0f1419">
<title>åŒ—æµ· ä»•å…¥ã‚ŒãƒŠãƒ“</title>
<style>
:root{
  --bg:#0f1419;--card:#1a2230;--border:#253040;
  --tx:#e4e9f0;--dim:#6e7f92;--mt:#3a4858;
  --ac:#f97316;--ac2:#fb923c;
  --fish:#0ea5e9;--sake:#eab308;--food:#22c55e;
  --red:#ef4444;--blue:#3b82f6;
}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,BlinkMacSystemFont,'Hiragino Sans','Noto Sans JP',sans-serif;background:var(--bg);color:var(--tx);-webkit-tap-highlight-color:transparent;overflow-x:hidden;font-size:14px;line-height:1.5}
button{font-family:inherit}

.hd{background:linear-gradient(135deg,#1a1040 0%,#0f1419 100%);padding:14px 16px;border-bottom:1px solid var(--border);position:sticky;top:0;z-index:50}
.hd h1{font-size:16px;font-weight:900;letter-spacing:-.3px}
.hd h1 b{color:var(--ac)}
.hd p{font-size:10px;color:var(--dim);margin-top:1px}

.wrap{padding:12px 12px 80px}

/* tabs */
.tabs{display:flex;gap:6px;margin-bottom:14px;overflow-x:auto;-webkit-overflow-scrolling:touch}
.tab{flex-shrink:0;padding:8px 16px;border-radius:20px;font-size:12px;font-weight:700;border:1px solid var(--border);background:var(--card);color:var(--dim);cursor:pointer;transition:.2s}
.tab.on{background:var(--ac);color:#fff;border-color:var(--ac)}

/* cards */
.cd{background:var(--card);border:1px solid var(--border);border-radius:10px;padding:14px;margin-bottom:10px}
.cd-t{font-size:11px;font-weight:700;color:var(--dim);letter-spacing:.5px;margin-bottom:10px;text-transform:uppercase}

/* date */
.drow{display:flex;gap:8px;align-items:center;margin-bottom:12px}
.drow input[type=date]{flex:1;background:var(--card);color:var(--tx);border:1px solid var(--border);border-radius:8px;padding:10px;font-size:15px;font-family:inherit;-webkit-appearance:none}
.go{background:var(--ac);color:#fff;border:none;border-radius:8px;padding:10px 14px;font-size:13px;font-weight:700;cursor:pointer;white-space:nowrap}
.go:active{transform:scale(.96)}

/* forecast row (horizontal scroll) */
.frow{display:flex;gap:8px;overflow-x:auto;-webkit-overflow-scrolling:touch;padding-bottom:6px;scroll-snap-type:x mandatory}
.frow::-webkit-scrollbar{display:none}
.fday{flex:0 0 calc(33.33% - 6px);scroll-snap-align:start;background:var(--card);border:1px solid var(--border);border-radius:10px;padding:12px 8px;text-align:center;min-width:110px}
.fday.hi{border-color:var(--ac);background:rgba(249,115,22,.06)}
.fday.off{opacity:.4}
.fday .dow{font-size:20px;font-weight:900;margin:2px 0}
.fday .dow.fs{color:var(--ac)}
.fday .dt{font-size:10px;color:var(--dim)}
.fday .wi{font-size:30px;margin:6px 0;line-height:1}
.fday select{width:100%;background:var(--bg);color:var(--tx);border:1px solid var(--border);border-radius:6px;padding:6px 2px;font-size:11px;font-family:inherit;text-align:center;-webkit-appearance:none;appearance:none}

/* big button */
.bigbtn{display:block;width:100%;background:linear-gradient(135deg,var(--ac),#ea580c);color:#fff;border:none;border-radius:10px;padding:14px;font-size:16px;font-weight:900;margin:14px 0;cursor:pointer;letter-spacing:.5px}
.bigbtn:active{transform:scale(.97)}

/* result summary strip */
.sstrip{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:12px}
.sbox{background:var(--card);border:1px solid var(--border);border-radius:10px;padding:12px;text-align:center}
.sbox .sv{font-size:22px;font-weight:900;letter-spacing:-.5px}
.sbox .sl{font-size:10px;color:var(--dim);margin-top:2px}
.sbox.t1{border-color:var(--ac);grid-column:1/3}
.sbox.t1 .sv{color:var(--ac);font-size:28px}
.sbox.f .sv{color:var(--fish)}
.sbox.s .sv{color:var(--sake)}
.sbox.fd .sv{color:var(--food)}

/* result day cards */
.rrow{display:flex;flex-direction:column;gap:8px}
.rday{background:var(--card);border:1px solid var(--border);border-radius:10px;padding:12px 14px;display:flex;align-items:center;gap:12px}
.rday.off{opacity:.35}
.rday .rl{flex-shrink:0;width:54px;text-align:center}
.rday .rl .rdow{font-size:16px;font-weight:900}
.rday .rl .rdow.fs{color:var(--ac)}
.rday .rl .rdt{font-size:10px;color:var(--dim)}
.rday .rl .rwi{font-size:18px}
.rday .rc{flex:1}
.rday .rsal{font-size:20px;font-weight:900;color:var(--ac);letter-spacing:-.5px}
.rday .rsal small{font-size:11px;color:var(--dim);font-weight:400;margin-left:4px}
.rday .rpur{display:flex;gap:10px;margin-top:4px;flex-wrap:wrap}
.rday .rp{font-size:12px;display:flex;align-items:center;gap:3px}
.rp .dot{width:7px;height:7px;border-radius:50%;flex-shrink:0}
.rp b{font-weight:700}
.df{background:var(--fish)}.ds{background:var(--sake)}.dfd{background:var(--food)}
.cf{color:var(--fish)}.cs{color:var(--sake)}.cfd{color:var(--food)}

/* Analysis tab */
.arow{display:flex;align-items:center;padding:10px 0;border-bottom:1px solid var(--border)}
.arow:last-child{border:none}
.arow .al{flex:1;font-size:13px}
.arow .av{font-size:15px;font-weight:900;min-width:70px;text-align:right}
.abr{height:6px;border-radius:3px;margin-top:4px}

.kv{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid var(--border);font-size:13px}
.kv:last-child{border:none}
.kv .k{color:var(--dim)}.kv .v{font-weight:700}

/* finding */
.find{background:rgba(249,115,22,.07);border:1px solid rgba(249,115,22,.2);border-radius:10px;padding:14px;margin-bottom:12px;font-size:13px;line-height:1.7}
.find b{color:var(--ac)}
.find .ft{font-size:11px;font-weight:900;color:var(--ac);margin-bottom:6px;letter-spacing:.5px}

/* hide */
.hide{display:none}
</style>
</head>
<body>

<div class="hd">
  <h1>ğŸ® åŒ—æµ· <b>ä»•å…¥ã‚ŒãƒŠãƒ“</b></h1>
  <p>é€±é–“å¤©æ°— â†’ å£²ä¸Šäºˆæ¸¬ â†’ æœ€é©ä»•å…¥é¡ï¼ˆ2025å¹´365æ—¥å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ï¼‰</p>
</div>

<div class="wrap">
  <div class="tabs">
    <div class="tab on" onclick="showTab(0)">ğŸ“Š äºˆæ¸¬</div>
    <div class="tab" onclick="showTab(1)">ğŸ“ˆ åˆ†æ</div>
    <div class="tab" onclick="showTab(2)">âš™ ãƒ¢ãƒ‡ãƒ«</div>
  </div>

  <!-- ===== TAB 0: PREDICTION ===== -->
  <div id="tab0">
    <div class="drow">
      <input type="date" id="sd">
      <button class="go" onclick="genWeek()">è¡¨ç¤º</button>
    </div>

    <div class="cd-t" style="margin-bottom:8px">â‘  å¤©æ°—äºˆå ±ã‚’å…¥åŠ›ï¼ˆæ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ« â†’ï¼‰</div>
    <div class="frow" id="frow"></div>

    <button class="bigbtn" onclick="calc()">ğŸ”® å£²ä¸Šäºˆæ¸¬ï¼†ä»•å…¥ã‚Œè¨ˆç®—</button>

    <div id="res" class="hide">
      <div class="cd-t">é€±é–“ã‚µãƒãƒªãƒ¼</div>
      <div class="sstrip" id="sstrip"></div>

      <div class="cd-t">æ—¥åˆ¥ äºˆæ¸¬ï¼†ä»•å…¥ã‚Œæ¨å¥¨</div>
      <div class="rrow" id="rrow"></div>

      <div style="margin-top:12px;padding:10px 12px;background:var(--card);border-radius:8px;font-size:11px;color:var(--dim);line-height:1.6">
        ğŸ’¡ é®®é­šï¼å£²ä¸ŠÃ—28%ï½œé…’é¡ï¼å£²ä¸ŠÃ—11%ï½œé£Ÿæï¼å£²ä¸ŠÃ—10%<br>
        âš  åœŸæ›œã®é®®é­šã¯ç¿Œå®šä¼‘ã‚’è€ƒæ…®ã—âˆ’20%èª¿æ•´æ¸ˆ
      </div>
    </div>
  </div>

  <!-- ===== TAB 1: ANALYSIS ===== -->
  <div id="tab1" class="hide">
    <div class="find">
      <div class="ft">ğŸ“Š 365æ—¥åˆ†æã®çµè«–</div>
      <b>å£²ä¸Šã‚’æ±ºã‚ã‚‹ã®ã¯ã€Œæ›œæ—¥ã€ã€‚å¤©å€™ã¯ã»ã¼ç„¡é–¢ä¿‚ã€‚</b><br>
      é‡‘æ›œÂ¥207Kãƒ»åœŸæ›œÂ¥195K vs ç«æ›œÂ¥134Kã€‚<br>
      æ°—æ¸©ã¨ã®ç›¸é–¢ r=0.024ï¼ˆã‚¼ãƒ­ï¼‰ã€‚<br>
      ä¾‹å¤–ï¼š<b>æœˆæ›œã®é›ªï¼åŠé¡</b>ã€<b>é‡‘æ›œã®å¤§é›¨ï¼3å‰²æ¸›</b>ã®ã¿ã€‚
    </div>

    <div class="cd">
      <div class="cd-t">æ›œæ—¥åˆ¥ å¹³å‡å£²ä¸Š</div>
      <div id="dowList"></div>
    </div>

    <div class="cd">
      <div class="cd-t">æ™‚é–“å¸¯åˆ¥ æ§‹æˆæ¯”</div>
      <div id="timeList"></div>
      <div style="margin-top:8px;font-size:11px;color:var(--dim)">22æ™‚ä»¥é™ï¼å…¨ä½“ã®8.5%ã€‚é–‰åº—å‰å€’ã—ã§å¹´Â¥430ä¸‡ã®äººä»¶è²»å‰Šæ¸›å¯èƒ½ã€‚</div>
    </div>

    <div class="cd">
      <div class="cd-t">å¤©å€™ã®å½±éŸ¿ï¼ˆæ›œæ—¥åˆ¥ï¼‰</div>
      <div style="overflow-x:auto">
        <table style="width:100%;font-size:11px;border-collapse:collapse;white-space:nowrap">
          <thead><tr style="color:var(--dim);border-bottom:1px solid var(--border)">
            <th style="padding:6px;text-align:left">æ›œ</th>
            <th style="padding:6px;text-align:right">â˜€æ™´</th>
            <th style="padding:6px;text-align:right">ğŸŒ¦å°é›¨</th>
            <th style="padding:6px;text-align:right">ğŸŒ§å¤§é›¨</th>
            <th style="padding:6px;text-align:right">â„é›ª</th>
          </tr></thead>
          <tbody id="wtbl"></tbody>
        </table>
      </div>
    </div>

    <div class="cd">
      <div class="cd-t">æœˆåˆ¥å£²ä¸Šï¼ˆ2025å¹´å®Ÿç¸¾ï¼‰</div>
      <div id="monList"></div>
    </div>

    <div class="cd">
      <div class="cd-t">å£²ä¸Šã¨ã®ç›¸é–¢ä¿‚æ•°</div>
      <div id="corrList"></div>
    </div>

    <div class="cd">
      <div class="cd-t">å£²ä¸Šãƒˆãƒƒãƒ—5 / ãƒ¯ãƒ¼ã‚¹ãƒˆ5</div>
      <div id="rankList"></div>
    </div>
  </div>

  <!-- ===== TAB 2: MODEL ===== -->
  <div id="tab2" class="hide">
    <div class="cd">
      <div class="cd-t">äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ä»•æ§˜</div>
      <div class="kv"><span class="k">ãƒ¢ãƒ‡ãƒ«ç¨®åˆ¥</span><span class="v">æ›œæ—¥Ã—æœˆÃ—å¤©å€™ éšå±¤å‹</span></div>
      <div class="kv"><span class="k">å­¦ç¿’ãƒ‡ãƒ¼ã‚¿</span><span class="v">2025å¹´ 307å–¶æ¥­æ—¥</span></div>
      <div class="kv"><span class="k">æ°—è±¡ãƒ‡ãƒ¼ã‚¿</span><span class="v">æ°—è±¡åº ç™½æ²³ 365æ—¥</span></div>
      <div class="kv"><span class="k">å¹´é–“å£²ä¸Š</span><span class="v" style="color:var(--ac)">Â¥50,214,540</span></div>
      <div class="kv"><span class="k">å–¶æ¥­æ—¥å¹³å‡</span><span class="v">Â¥163,565</span></div>
      <div class="kv"><span class="k">å®šä¼‘æ—¥</span><span class="v">æ—¥æ›œ</span></div>
    </div>
    <div class="cd">
      <div class="cd-t">ç²¾åº¦</div>
      <div class="kv"><span class="k">å¹³å‡èª¤å·®ç‡</span><span class="v">25.4%</span></div>
      <div class="kv"><span class="k">Â±20%ä»¥å†…</span><span class="v">55.2%</span></div>
      <div class="kv"><span class="k">Â±30%ä»¥å†…</span><span class="v" style="color:var(--food)">74.9%</span></div>
      <div class="kv"><span class="k">æœ€å¤§å½±éŸ¿å› å­</span><span class="v" style="color:var(--ac)">æ›œæ—¥ r=+0.473</span></div>
    </div>
    <div class="cd">
      <div class="cd-t">ä»•å…¥ã‚Œä¿‚æ•°ï¼ˆå®Ÿä»•å…¥ãƒ¬ã‚·ãƒ¼ãƒˆã‚ˆã‚Šï¼‰</div>
      <div class="kv"><span class="k">ğŸŸ é®®é­š</span><span class="v cf">å£²ä¸Š Ã— 28%</span></div>
      <div class="kv"><span class="k">ğŸ¶ é…’é¡</span><span class="v cs">å£²ä¸Š Ã— 11%</span></div>
      <div class="kv"><span class="k">ğŸ¥¬ ãã®ä»–é£Ÿæ</span><span class="v cfd">å£²ä¸Š Ã— 10%</span></div>
      <div class="kv"><span class="k">âš  åœŸæ›œé®®é­š</span><span class="v" style="color:var(--red)">âˆ’20%ï¼ˆç¿Œå®šä¼‘ï¼‰</span></div>
    </div>
    <div class="cd">
      <div class="cd-t">äºˆæ¸¬ãƒ­ã‚¸ãƒƒã‚¯</div>
      <div style="font-size:12px;color:var(--dim);line-height:1.8">
        äºˆæ¸¬å£²ä¸Š ï¼ <b style="color:var(--tx)">æ›œæ—¥ãƒ™ãƒ¼ã‚¹</b> Ã— <b style="color:var(--tx)">æœˆä¿‚æ•°</b> Ã— <b style="color:var(--tx)">å¤©å€™è£œæ­£</b><br><br>
        ä¾‹ï¼‰2æœˆãƒ»é‡‘æ›œãƒ»å¤§é›¨ã®å ´åˆ<br>
        Â¥211,595 Ã— 0.878 Ã— 0.69 ï¼ <b style="color:var(--ac)">Â¥128,180</b><br><br>
        ä¾‹ï¼‰8æœˆãƒ»åœŸæ›œãƒ»æ™´ã‚Œã®å ´åˆ<br>
        Â¥195,840 Ã— 1.093 Ã— 1.00 ï¼ <b style="color:var(--ac)">Â¥213,953</b>
      </div>
    </div>
  </div>
</div>

<script>
// ===== MODEL =====
const M={
  base:{æœˆ:155780,ç«:126785,æ°´:131680,æœ¨:148540,é‡‘:211595,åœŸ:195840,æ—¥:0},
  mf:{
    æœˆ:{1:.719,2:.846,3:.806,4:1.083,5:1.164,6:.649,7:.649,8:1.306,9:1.218,10:1.130,11:1.204,12:1.239},
    ç«:{1:.478,2:1.036,3:1.079,4:.797,5:1.005,6:.931,7:1.124,8:1.190,9:.730,10:1.303,11:1.027,12:1.376},
    æ°´:{1:.869,2:.932,3:1.088,4:.748,5:.876,6:.854,7:1.017,8:1.264,9:.876,10:1.334,11:.925,12:1.186},
    æœ¨:{1:1.018,2:1.142,3:.874,4:1.096,5:.914,6:.933,7:.966,8:1.129,9:.913,10:1.174,11:.998,12:.855},
    é‡‘:{1:1.042,2:.878,3:1.066,4:1.095,5:.743,6:1.052,7:1.192,8:.878,9:.806,10:1.004,11:1.153,12:1.168},
    åœŸ:{1:.848,2:.904,3:.853,4:.981,5:.950,6:1.098,7:1.062,8:1.093,9:1.016,10:.990,11:1.088,12:1.093}
  },
  wf:{
    æœˆ:{d:1,l:1.10,h:1.05,s:.56},ç«:{d:1,l:1.10,h:.89,s:.86},
    æ°´:{d:1,l:1.02,h:.80,s:.90},æœ¨:{d:1,l:.98,h:.92,s:.99},
    é‡‘:{d:1,l:1.14,h:.69,s:.92},åœŸ:{d:1,l:1.08,h:.93,s:.75}
  },
  pr:{fish:.28,drink:.11,food:.10}
};
const DN=['æ—¥','æœˆ','ç«','æ°´','æœ¨','é‡‘','åœŸ'];
const WO=[{v:'d',l:'â˜€ æ™´/æ›‡',i:'â˜€'},{v:'l',l:'ğŸŒ¦ å°é›¨',i:'ğŸŒ¦'},{v:'h',l:'ğŸŒ§ å¤§é›¨',i:'ğŸŒ§'},{v:'s',l:'â„ é›ª',i:'â„'}];

function pred(dow,mo,w){
  if(dow==='æ—¥')return 0;
  return Math.round((M.base[dow]||0)*(M.mf[dow]||{})[mo]||1)*((M.wf[dow]||{})[w]||1);
}
function yen(n){return n?'Â¥'+n.toLocaleString():'â€”'}
function yenK(n){return n>=10000?'Â¥'+(n/10000).toFixed(1)+'ä¸‡':n?'Â¥'+Math.round(n/1000)+'K':'â€”'}

// Tab
function showTab(n){
  document.querySelectorAll('.tab').forEach((t,i)=>{t.classList.toggle('on',i===n)});
  for(let i=0;i<3;i++)document.getElementById('tab'+i).classList.toggle('hide',i!==n);
}

// Week generation
function getNextMon(){
  const d=new Date();const diff=d.getDay()===0?1:d.getDay()===1?0:8-d.getDay();
  d.setDate(d.getDate()+diff);return d;
}
function genWeek(){
  const inp=document.getElementById('sd');
  const s=inp.value?new Date(inp.value+'T00:00:00'):getNextMon();
  const fr=document.getElementById('frow');fr.innerHTML='';
  for(let i=0;i<7;i++){
    const d=new Date(s);d.setDate(s.getDate()+i);
    const dow=DN[d.getDay()],mo=d.getMonth()+1,dt=mo+'/'+d.getDate();
    const off=dow==='æ—¥',fs=dow==='é‡‘'||dow==='åœŸ';
    const div=document.createElement('div');
    div.className='fday'+(fs?' hi':'')+(off?' off':'');
    div.dataset.dow=dow;div.dataset.mo=mo;
    div.dataset.ds=d.getFullYear()+'/'+String(mo).padStart(2,'0')+'/'+String(d.getDate()).padStart(2,'0');
    if(off){
      div.innerHTML=`<div class="dt">${dt}</div><div class="dow" style="color:var(--mt)">${dow}</div><div class="wi" style="opacity:.3">ğŸš«</div><div style="font-size:10px;color:var(--mt)">å®šä¼‘æ—¥</div>`;
    }else{
      div.innerHTML=`<div class="dt">${dt}</div><div class="dow${fs?' fs':''}">${dow}</div><div class="wi" id="wi${i}">â˜€</div><select id="ws${i}" onchange="document.getElementById('wi${i}').textContent=WO.find(o=>o.v===this.value).i">${WO.map(o=>`<option value="${o.v}">${o.l}</option>`).join('')}</select>`;
    }
    fr.appendChild(div);
  }
  document.getElementById('res').classList.add('hide');
}

function calc(){
  const days=document.querySelectorAll('.fday');
  let wT=0,wF=0,wD=0,wFd=0;const results=[];
  days.forEach((el,i)=>{
    const dow=el.dataset.dow,mo=+el.dataset.mo,ds=el.dataset.ds;
    const sel=document.getElementById('ws'+i);
    const w=sel?sel.value:'d';
    const p=pred(dow,mo,w);
    const isSat=dow==='åœŸ';
    const fish=Math.round(p*M.pr.fish*(isSat?.8:1));
    const drink=Math.round(p*M.pr.drink);
    const food=Math.round(p*M.pr.food);
    wT+=p;wF+=fish;wD+=drink;wFd+=food;
    results.push({dow,mo,ds,w,p,fish,drink,food,off:dow==='æ—¥'});
  });
  // Summary
  document.getElementById('sstrip').innerHTML=`
    <div class="sbox t1"><div class="sv">${yenK(wT)}</div><div class="sl">é€±é–“äºˆæ¸¬å£²ä¸Š</div></div>
    <div class="sbox f"><div class="sv">${yen(wF)}</div><div class="sl">ğŸŸ é®®é­šä»•å…¥</div></div>
    <div class="sbox s"><div class="sv">${yen(wD)}</div><div class="sl">ğŸ¶ é…’é¡ä»•å…¥</div></div>
    <div class="sbox fd" style="grid-column:1/3"><div class="sv">${yen(wFd)}</div><div class="sl">ğŸ¥¬ ãã®ä»–é£Ÿæ</div></div>
  `;
  // Day list
  const rr=document.getElementById('rrow');rr.innerHTML='';
  results.forEach(r=>{
    const wi=WO.find(o=>o.v===r.w);
    const fs=r.dow==='é‡‘'||r.dow==='åœŸ';
    if(r.off){
      rr.innerHTML+=`<div class="rday off"><div class="rl"><div class="rdow">${r.dow}</div><div class="rdt">${r.ds.slice(5)}</div></div><div class="rc"><div class="rsal" style="color:var(--mt);font-size:14px">å®šä¼‘æ—¥</div></div></div>`;
    }else{
      rr.innerHTML+=`<div class="rday"><div class="rl"><div class="rdow${fs?' fs':''}">${r.dow}</div><div class="rdt">${r.ds.slice(5)}</div><div class="rwi">${wi?wi.i:'â˜€'}</div></div><div class="rc"><div class="rsal">${yenK(r.p)}<small>äºˆæ¸¬</small></div><div class="rpur"><div class="rp"><span class="dot df"></span>ğŸŸ<b class="cf">${yen(r.fish)}</b></div><div class="rp"><span class="dot ds"></span>ğŸ¶<b class="cs">${yen(r.drink)}</b></div><div class="rp"><span class="dot dfd"></span>ğŸ¥¬<b class="cfd">${yen(r.food)}</b></div></div></div></div>`;
    }
  });
  document.getElementById('res').classList.remove('hide');
  document.getElementById('res').scrollIntoView({behavior:'smooth'});
}

// ===== ANALYSIS TAB DATA =====
function initAnalysis(){
  // DOW
  const dw=[{d:'æœˆ',v:148165},{d:'ç«',v:134484},{d:'æ°´',v:141542},{d:'æœ¨',v:153585},{d:'é‡‘',v:207285},{d:'åœŸ',v:195104}];
  const mx=Math.max(...dw.map(x=>x.v));
  document.getElementById('dowList').innerHTML=dw.map(x=>{
    const p=x.v/mx*100;const c=x.d==='é‡‘'||x.d==='åœŸ'?'var(--ac)':'var(--blue)';
    return `<div class="arow"><div class="al">${x.d}æ›œ</div><div class="av" style="color:${c}">${yenK(x.v)}</div></div><div class="abr" style="width:${p}%;background:${c}"></div>`;
  }).join('');

  // Time
  const tm=[{h:'17æ™‚',p:12.1},{h:'18æ™‚',p:27.4},{h:'19æ™‚',p:26.1},{h:'20æ™‚',p:15.9},{h:'21æ™‚',p:10.0},{h:'22æ™‚',p:5.9},{h:'23æ™‚',p:2.3},{h:'24æ™‚',p:0.3}];
  const tmx=Math.max(...tm.map(x=>x.p));
  document.getElementById('timeList').innerHTML=tm.map(x=>{
    const p=x.p/tmx*100;const c=x.p>20?'var(--ac)':x.p>10?'var(--blue)':'var(--mt)';
    return `<div class="arow"><div class="al">${x.h}</div><div class="av" style="color:${c}">${x.p}%</div></div><div class="abr" style="width:${p}%;background:${c}"></div>`;
  }).join('');

  // Weather table
  const wt=[
    {d:'æœˆ',a:143,b:158,c:150,e:80},{d:'ç«',a:135,b:149,c:120,e:115},
    {d:'æ°´',a:147,b:151,c:118,e:132},{d:'æœ¨',a:156,b:153,c:143,e:154},
    {d:'é‡‘',a:205,b:234,c:161,e:212},{d:'åœŸ',a:193,b:208,c:195,e:157}
  ];
  const cl=(v,b)=>v/b<.8?'color:var(--red);font-weight:700':v/b>1.1?'color:var(--food);font-weight:700':'';
  document.getElementById('wtbl').innerHTML=wt.map(x=>{
    const fs=x.d==='é‡‘'||x.d==='åœŸ'?'color:var(--ac);font-weight:700':'';
    return `<tr style="border-bottom:1px solid var(--border)"><td style="padding:6px;${fs}">${x.d}</td><td style="padding:6px;text-align:right">Â¥${x.a}K</td><td style="padding:6px;text-align:right;${cl(x.b,x.a)}">Â¥${x.b}K</td><td style="padding:6px;text-align:right;${cl(x.c,x.a)}">Â¥${x.c}K</td><td style="padding:6px;text-align:right;${cl(x.e,x.a)}">Â¥${x.e}K</td></tr>`;
  }).join('');

  // Month
  const mo=[{m:'1æœˆ',v:349},{m:'2æœˆ',v:371},{m:'3æœˆ',v:404},{m:'4æœˆ',v:405},{m:'5æœˆ',v:397},{m:'6æœˆ',v:377},{m:'7æœˆ',v:439},{m:'8æœˆ',v:477},{m:'9æœˆ',v:389},{m:'10æœˆ',v:493},{m:'11æœˆ',v:434},{m:'12æœˆ',v:487}];
  const mmx=Math.max(...mo.map(x=>x.v));
  document.getElementById('monList').innerHTML=mo.map(x=>{
    const p=x.v/mmx*100;const c=x.v>450?'var(--ac)':'var(--blue)';
    return `<div class="arow"><div class="al">${x.m}</div><div class="av" style="color:${c}">Â¥${x.v}ä¸‡</div></div><div class="abr" style="width:${p}%;background:${c}"></div>`;
  }).join('');

  // Correlation
  const cr=[{l:'é‡‘åœŸãƒ€ãƒŸãƒ¼',v:.473,c:'var(--ac)'},{l:'æœˆ',v:.201,c:'var(--blue)'},{l:'æ—¥ç…§æ™‚é–“',v:.053,c:'var(--mt)'},{l:'æ°—æ¸©',v:.024,c:'var(--mt)'},{l:'é™æ°´é‡',v:-.036,c:'var(--mt)'}];
  document.getElementById('corrList').innerHTML=cr.map(x=>{
    const p=Math.abs(x.v)/.5*100;
    return `<div class="arow"><div class="al">${x.l}</div><div class="av" style="color:${x.c}">${x.v>=0?'+':''}${x.v.toFixed(3)}</div></div><div class="abr" style="width:${p}%;background:${x.c}"></div>`;
  }).join('');

  // Rank
  const top=[
    {d:'8/2(åœŸ)',v:331920,w:'â˜”26â„ƒ'},{d:'7/4(é‡‘)',v:330520,w:'â˜”25â„ƒ'},{d:'12/29(æœˆ)',v:315180,w:'â˜€2â„ƒ'},
    {d:'1/24(é‡‘)',v:302160,w:'â˜€4â„ƒ'},{d:'6/27(é‡‘)',v:294540,w:'â˜€23â„ƒ'}
  ];
  const bot=[
    {d:'3/3(æœˆ)',v:19470,w:'â˜”1â„ƒ'},{d:'1/7(ç«)',v:25990,w:'â˜€6â„ƒ'},{d:'1/14(ç«)',v:30740,w:'â˜€2â„ƒ'},
    {d:'6/16(æœˆ)',v:39450,w:'â˜€24â„ƒ'},{d:'9/23(ç«)',v:44150,w:'â˜€17â„ƒ'}
  ];
  let rhtml='<div style="font-size:12px;font-weight:700;color:var(--food);margin:8px 0 4px">ğŸ† ãƒˆãƒƒãƒ—5</div>';
  top.forEach(x=>{rhtml+=`<div class="arow"><div class="al">${x.d} ${x.w}</div><div class="av" style="color:var(--ac)">${yen(x.v)}</div></div>`});
  rhtml+='<div style="font-size:12px;font-weight:700;color:var(--red);margin:12px 0 4px">âš  ãƒ¯ãƒ¼ã‚¹ãƒˆ5</div>';
  bot.forEach(x=>{rhtml+=`<div class="arow"><div class="al">${x.d} ${x.w}</div><div class="av" style="color:var(--red)">${yen(x.v)}</div></div>`});
  document.getElementById('rankList').innerHTML=rhtml;
}

// Init
window.addEventListener('DOMContentLoaded',()=>{
  const m=getNextMon();
  document.getElementById('sd').value=m.toISOString().split('T')[0];
  genWeek();
  initAnalysis();
});
</script>
</body>
</html>
